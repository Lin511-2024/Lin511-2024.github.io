<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Josef Fruehwald">
<meta name="dcterms.date" content="2024-02-13">

<title>Lin511-2024 - ngrams</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../notes/meetings/05_ngrams2.html" rel="next">
<link href="../../notes/meetings/03_tokenization.html" rel="prev">
<link href="../../assets/logo.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/codenamelabel/codeblocklabel.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/styles.css">
<meta property="og:title" content="Lin511-2024 - ngrams">
<meta property="og:description" content="-or- What if we could parse natural language with a finite state automaton?">
<meta property="og:site_name" content="Lin511-2024">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Lin511-2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Lin511-2024"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../notes/meetings/01_fsm.html">Class Meetings</a></li><li class="breadcrumb-item"><a href="../../notes/meetings/04_ngrams.html">ngrams</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../assets/logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Concepts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/concepts/00_glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/concepts/01_keyboarding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">“Where is the … key?”</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/concepts/01_what-is-python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What <em>is</em> Python?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/concepts/02_undersdanding-paths.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understanding Directories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/concepts/03_navigating-directories.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Navigating Directories</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/concepts/04_git_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git Errors</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Class Meetings</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/01_fsm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regular Languages and Finite State Machines</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/01-1_fsm_addenda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FSA in-class notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/02_pda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pushdown Automata and Context Free Languages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/03_tokenization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tokenization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/04_ngrams.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">ngrams</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/05_ngrams2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling from a probability distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/06_side-note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Side Note</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/07_information-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Information Theory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/08_ngram_smoothing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ngram “smoothing”</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/meetings/09_markov_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markov Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Programming</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/programming/00_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/programming/01_Python_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/programming/02_regex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regular Expressions, Quickly</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/programming/03_python_plus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">More Python: Poetry, Lists, Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/programming/04_tokenizers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Tokenizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/programming/05_ngrams.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Making and Counting ngrams in python</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">In-class</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../notes/in_class/00_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Starting Python</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#states-and-words" id="toc-states-and-words" class="nav-link active" data-scroll-target="#states-and-words">States and Words</a>
  <ul>
  <li><a href="#grams" id="toc-grams" class="nav-link" data-scroll-target="#grams">*grams</a></li>
  <li><a href="#probabilistic-ngrams" id="toc-probabilistic-ngrams" class="nav-link" data-scroll-target="#probabilistic-ngrams">Probabilistic ngrams</a></li>
  </ul></li>
  <li><a href="#terminology-and-notation-moment" id="toc-terminology-and-notation-moment" class="nav-link" data-scroll-target="#terminology-and-notation-moment">Terminology and Notation Moment</a>
  <ul>
  <li><a href="#types-vs-tokens" id="toc-types-vs-tokens" class="nav-link" data-scroll-target="#types-vs-tokens">Types vs Tokens</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation">Notation</a>
  <ul class="collapse">
  <li><a href="#words-and-variables" id="toc-words-and-variables" class="nav-link" data-scroll-target="#words-and-variables">Words and variables</a></li>
  <li><a href="#counting-words" id="toc-counting-words" class="nav-link" data-scroll-target="#counting-words">Counting Words</a></li>
  <li><a href="#probabilities" id="toc-probabilities" class="nav-link" data-scroll-target="#probabilities">Probabilities</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#language-prediction" id="toc-language-prediction" class="nav-link" data-scroll-target="#language-prediction">Language Prediction</a></li>
  <li><a href="#using-context-ngrams" id="toc-using-context-ngrams" class="nav-link" data-scroll-target="#using-context-ngrams">Using context (ngrams)</a></li>
  <li><a href="#data-sparsity" id="toc-data-sparsity" class="nav-link" data-scroll-target="#data-sparsity">Data Sparsity</a>
  <ul>
  <li><a href="#the-problem-with-data-sparsity" id="toc-the-problem-with-data-sparsity" class="nav-link" data-scroll-target="#the-problem-with-data-sparsity">The <em>problem</em> with data sparsity</a></li>
  <li><a href="#approximating-with-ngrams" id="toc-approximating-with-ngrams" class="nav-link" data-scroll-target="#approximating-with-ngrams">Approximating with ngrams</a></li>
  </ul></li>
  <li><a href="#calculating-probabilities" id="toc-calculating-probabilities" class="nav-link" data-scroll-target="#calculating-probabilities">Calculating probabilities</a>
  <ul>
  <li><a href="#log-probabilities" id="toc-log-probabilities" class="nav-link" data-scroll-target="#log-probabilities">Log Probabilities</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Lin511-2024/Lin511-2024.github.io/blob/main/notes/meetings/04_ngrams.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../notes/meetings/01_fsm.html">Class Meetings</a></li><li class="breadcrumb-item"><a href="../../notes/meetings/04_ngrams.html">ngrams</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">ngrams</h1>
<p class="subtitle lead">-or- What if we <em>could</em> parse natural language with a finite state automaton?</p>
  <div class="quarto-categories">
    <div class="quarto-category">compling</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://jofrhwld.github.io/">Josef Fruehwald</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 13, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 7, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<p>So, in our notes on <a href="../../notes/meetings/01_fsm.html">finite state automata</a> and <a href="../../notes/meetings/02_pda.html">push-down automata</a> we concluded that since natural language has bracket matching patterns, and maybe even crossing dependencies, that it’s more complex than a “regular” language, and can’t really be parsed with a finite state automaton.</p>
<p>ngram language modelling asks the question: But what if we tried really hard?</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>True

[nltk_data] Downloading package punkt to /Users/runner/nltk_data...
[nltk_data]   Unzipping tokenizers/punkt.zip.</code></pre>
</div>
</div>
<section id="states-and-words" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="states-and-words">States and Words</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p>The first sentence of Moby Dick is, famously,</p>
<blockquote class="blockquote">
<p>Call me Ishmael.</p>
</blockquote>
<p>We could try representing this as a finite state automaton like so:</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram
    direction LR

    [*] --&gt; call: call
    call --&gt; me: me
    me --&gt; ishmael: ishmael
    ishmael --&gt; [*]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>But, this is <em>far</em> from a complete model of the whole book <em>Moby Dick</em>. It would only work if the entire book was just “Call me Ishmael” over and over again.</p>
<p>To enrich the FSA, we could add all of the other words that could follow <em>“call”.</em></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram
    direction LR

    [*] --&gt; call: call
    call --&gt; call: call
    call --&gt; it: it
    call --&gt; a: a
    call --&gt; me: me
    call --&gt; him: him
    call --&gt; ...
    call --&gt; [*]

    me --&gt; ishmael: ishmael
    me --&gt; call: call

    ishmael --&gt; [*]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>But, lots of other words could <em>also</em> follow <em>“me”</em>. And more words could also follow <em>“Ishmael”</em></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram
    direction LR

    [*] --&gt; call: call
    call --&gt; call: call
    call --&gt; it: it
    call --&gt; a: a
    call --&gt; me: me
    call --&gt; him: him
    call --&gt; ...
    call --&gt; [*]

    me --&gt; me: me
    me --&gt; call: call
    me --&gt; that: that
    me --&gt; and: and
    me --&gt; ishmael: ishmael
    me --&gt; to: to
    me --&gt; ...
    me --&gt; [*]

    ishmael --&gt; ishmael: ishmael
    ishmael --&gt; me: me
    ishmael --&gt; can: can
    ishmael --&gt; said: said
    ishmael --&gt; ...
    ishmael --&gt; [*]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>If we fully fleshed out this diagram with <em>all</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> of words in <em>Moby Dick</em>, it would look like this</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-moby_dick_network" class="quarto-figure quarto-figure-center quarto-float anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-moby_dick_network-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04_ngrams_files/figure-html/fig-moby_dick_network-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-moby_dick_network-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Bigram network for Moby Dick, where <span class="math inline">\(C(w_1, w_2)\ge 5\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<section id="grams" class="level3">
<h3 class="anchored" data-anchor-id="grams">*grams</h3>
<p>The “model” of word sequences is called an “ngram” model or more specifically a “bigram” model.</p>
<table class="table">
<caption>How we name *gram models</caption>
<thead>
<tr class="header">
<th>Words in the current state</th>
<th>Words in input</th>
<th>Total Words</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
<td>bigram</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>3</td>
<td>trigram</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1</td>
<td>4</td>
<td>4-gram</td>
</tr>
<tr class="even">
<td>4</td>
<td>1</td>
<td>5</td>
<td>5-gram</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td>etc</td>
</tr>
</tbody>
</table>
<p>We can expand the context of the bigram model to a trigram model, which would look something like this</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram
  direction LR
  
  state "_ call" as _c
  state "call me" as cm
  state "me Ishmael" as mi
  
  [*] --&gt; _
  _ --&gt; _c: call
  _c --&gt; cm: me
  cm --&gt; mi: Ishmael
  mi --&gt; [*]
  
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>But, again, even for this small vocabulary, this <em>total</em> number of states is incomplete. If we wired up <em>all</em> of the logical transitions they’d look like this <a href="https://en.wikipedia.org/wiki/Illithid">ilithid</a> monstrosity.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram
    direction LR

    state "_ call" as _c
    state "_ me" as _m
    state "_ Ishmael" as _i
    
    state "call me" as cm
    state "call call" as cc
    state "call Ishmael" as ci

    state "me Ishmael" as mi
    state "me call" as mc
    state "me me" as mm

    state "Ishmael call" as ic
    state "Ishmael Ishmael" as ii
    state "Ishmael me" as im

    [*] --&gt; _: _
    _ --&gt; _m: me
    _ --&gt; _c: call
    _ --&gt; _i: Ishmael
    

    _c --&gt; cm: me
    _c --&gt; cc: call
    _c --&gt; ci: Ishmael

    cc --&gt; cc: call
    cc --&gt; ci: Ishmael
    cc --&gt; cm: me

    ci --&gt; ii: Ishmael
    ci --&gt; im: me
    ci --&gt; ic: call

    cm --&gt; mi: Ishmael
    cm --&gt; mm: me
    cm --&gt; mc: call

    _m --&gt; mc: call
    _m --&gt; mm: me
    _m --&gt; mi: Ishmael
    
    mm --&gt; mm: me
    mm --&gt; mc: call
    mm --&gt; mi: Ishmael

    mi --&gt; ii: Ishmael
    mi --&gt; ic: call
    mi --&gt; im: me

    mc --&gt; cm: me
    mc --&gt; ci: Ishmael
    mc --&gt; cc: call



    _i --&gt; ic: call
    _i --&gt; im: me
    _i --&gt; ii: Ishmael

    ic --&gt; cc: call
    ic --&gt; cm: me
    ic --&gt; ci: Ishmael

    im --&gt; mi: Ishmael
    im --&gt; mc: call
    im --&gt; mm: me

    ii --&gt; im: me
    ii --&gt; ic: call
    ii --&gt; ii: Ishmael
    
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="probabilistic-ngrams" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic-ngrams">Probabilistic ngrams</h3>
<p>But, if we look at the actual entire book <em>Moby Dick,</em> not all of these connections are equally likely.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="bvhufrgfsy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bvhufrgfsy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bvhufrgfsy thead, #bvhufrgfsy tbody, #bvhufrgfsy tfoot, #bvhufrgfsy tr, #bvhufrgfsy td, #bvhufrgfsy th {
  border-style: none;
}

#bvhufrgfsy p {
  margin: 0;
  padding: 0;
}

#bvhufrgfsy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bvhufrgfsy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bvhufrgfsy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bvhufrgfsy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bvhufrgfsy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bvhufrgfsy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bvhufrgfsy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bvhufrgfsy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bvhufrgfsy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bvhufrgfsy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bvhufrgfsy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bvhufrgfsy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bvhufrgfsy .gt_spanner_row {
  border-bottom-style: hidden;
}

#bvhufrgfsy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bvhufrgfsy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bvhufrgfsy .gt_from_md > :first-child {
  margin-top: 0;
}

#bvhufrgfsy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bvhufrgfsy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bvhufrgfsy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bvhufrgfsy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bvhufrgfsy .gt_row_group_first td {
  border-top-width: 2px;
}

#bvhufrgfsy .gt_row_group_first th {
  border-top-width: 2px;
}

#bvhufrgfsy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvhufrgfsy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bvhufrgfsy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bvhufrgfsy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bvhufrgfsy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvhufrgfsy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bvhufrgfsy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bvhufrgfsy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bvhufrgfsy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bvhufrgfsy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bvhufrgfsy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvhufrgfsy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bvhufrgfsy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bvhufrgfsy .gt_left {
  text-align: left;
}

#bvhufrgfsy .gt_center {
  text-align: center;
}

#bvhufrgfsy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bvhufrgfsy .gt_font_normal {
  font-weight: normal;
}

#bvhufrgfsy .gt_font_bold {
  font-weight: bold;
}

#bvhufrgfsy .gt_font_italic {
  font-style: italic;
}

#bvhufrgfsy .gt_super {
  font-size: 65%;
}

#bvhufrgfsy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bvhufrgfsy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bvhufrgfsy .gt_indent_1 {
  text-indent: 5px;
}

#bvhufrgfsy .gt_indent_2 {
  text-indent: 10px;
}

#bvhufrgfsy .gt_indent_3 {
  text-indent: 15px;
}

#bvhufrgfsy .gt_indent_4 {
  text-indent: 20px;
}

#bvhufrgfsy .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings gt_spanner_row">
<th rowspan="2" id="next word" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">next word</th>
<th colspan="3" id="word" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner">word</span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="call" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">call</th>
<th id="me" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">me</th>
<th id="ishmael" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ishmael</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td id="stub_1_1" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">call</td>
<td class="gt_row gt_right" headers="stub_1_1 call" style="background-color: #808080; color: #FFFFFF">0</td>
<td class="gt_row gt_right" headers="stub_1_1 me" style="background-color: #FFEBEE; color: #000000">1</td>
<td class="gt_row gt_right" headers="stub_1_1 ishmael" style="background-color: #808080; color: #FFFFFF">0</td>
</tr>
<tr class="even">
<td id="stub_1_2" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">ishmael</td>
<td class="gt_row gt_right" headers="stub_1_2 call" style="background-color: #808080; color: #FFFFFF">0</td>
<td class="gt_row gt_right" headers="stub_1_2 me" style="background-color: #FFEBEE; color: #000000">1</td>
<td class="gt_row gt_right" headers="stub_1_2 ishmael" style="background-color: #808080; color: #FFFFFF">0</td>
</tr>
<tr class="odd">
<td id="stub_1_3" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">me</td>
<td class="gt_row gt_right" headers="stub_1_3 call" style="background-color: #B71C1C; color: #FFFFFF">3</td>
<td class="gt_row gt_right" headers="stub_1_3 me" style="background-color: #808080; color: #FFFFFF">0</td>
<td class="gt_row gt_right" headers="stub_1_3 ishmael" style="background-color: #808080; color: #FFFFFF">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">%% fig-align: center
flowchart LR
    c["call"] ==&gt; m["me"]
    m --&gt; c
    m --&gt; i["Ishmael"]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
<section id="terminology-and-notation-moment" class="level2">
<h2 class="anchored" data-anchor-id="terminology-and-notation-moment">Terminology and Notation Moment</h2>
<section id="types-vs-tokens" class="level3">
<h3 class="anchored" data-anchor-id="types-vs-tokens">Types vs Tokens</h3>
<details>
<summary>
A function to get all of the words in Moby Dick
</summary>
<div class="cell">
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gutenbergpy.textget</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_moby_dick_words():</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  raw_book <span class="op">=</span> gutenbergpy.textget.get_text_by_id(<span class="dv">2701</span>) <span class="co"># with headers</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  moby_dick_byte <span class="op">=</span> gutenbergpy.textget.strip_headers(raw_book) <span class="co"># without headers</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  moby_dick <span class="op">=</span> moby_dick_byte.decode(<span class="st">"utf-8"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  moby_dick_tokens <span class="op">=</span> word_tokenize(moby_dick)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  moby_dick_words <span class="op">=</span> [tok <span class="cf">for</span> tok <span class="kw">in</span> moby_dick_tokens]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> moby_dick_words</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<div class="codebox">
<div class="cell">
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>moby_dick_words <span class="op">=</span> get_moby_dick_words()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, word <span class="kw">in</span> <span class="bu">enumerate</span>(moby_dick_words[<span class="dv">0</span>:<span class="dv">20</span>]):</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(word, end <span class="op">=</span> <span class="st">", "</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (idx<span class="op">+</span><span class="dv">1</span>) <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>     <span class="bu">print</span>(<span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>MOBY-DICK, ;, or, ,, THE, 
WHALE, ., By, Herman, Melville, 
CONTENTS, ETYMOLOGY, ., EXTRACTS, (, 
Supplied, by, a, Sub-Sub-Librarian, ), </code></pre>
</div>
</div>
</div>
<p>We can get counts of how often each word appeared in the book with <code>collections.Counter()</code> .</p>
<div class="codebox">
<div class="cell">
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>word_count <span class="op">=</span> Counter(moby_dick_words)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Let’s compare the length of the full list of words to the length of the word count dictionary.</p>
<div class="codebox">
<div class="cell">
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"There are </span><span class="sc">{</span><span class="bu">len</span>(moby_dick_words)<span class="sc">:,}</span><span class="ss"> total  words."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 255,958 total  words.</code></pre>
</div>
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"There are  </span><span class="sc">{</span><span class="bu">len</span>(word_count)<span class="sc">:,}</span><span class="ss"> unique words."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are  21,897 unique words.</code></pre>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology
</div>
</div>
<div class="callout-body-container callout-body">
<p>In more common corpus/compling terminology, we would say</p>
<ul>
<li><p>There are 215,300 <strong>tokens</strong> in <em>Moby Dick</em>.</p></li>
<li><p>There are 19,989 <strong>types</strong> in <em>Moby Dick</em>.</p></li>
</ul>
</div>
</div>
<p>We can get the frequency of the words “whale” and “ogre” in <em>Moby Dick</em> like so:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Indexing with a string?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can index <code>word_count</code> with the string <code>"whale"</code> because it is a <a href="../../notes/concepts/00_glossary.html#dictionary">“dictionary”</a> We could create our own dictionary like this:</p>
<div class="cell">
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>food_type <span class="op">=</span> {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"banana"</span>: <span class="st">"fruit"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"strawberry"</span>: <span class="st">"fruit"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"carrot"</span>: <span class="st">"vegetable"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"onion"</span>: <span class="st">"vegetable"</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>food_type[<span class="st">"banana"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'fruit'</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="codebox">
<div class="cell">
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The word 'whale' appeared </span><span class="sc">{</span>word_count[<span class="st">'whale'</span>]<span class="sc">:,}</span><span class="ss"> times."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The word 'whale' appeared 771 times.</code></pre>
</div>
<div class="langname">
<pre class="langname">python</pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The word  'ogre' appeared    </span><span class="sc">{</span>word_count[<span class="st">'ogre'</span>]<span class="sc">}</span><span class="ss"> times."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The word  'ogre' appeared    0 times.</code></pre>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Terminology
</div>
</div>
<div class="callout-body-container callout-body">
<p>The way we’d describe this in a more corpus/comp-ling way is</p>
<blockquote class="blockquote">
<p>The word <strong>type</strong> “whale” appears in <em>Moby Dick</em>. There are 1,070 <strong>tokens</strong> of “whale” in the book.</p>
<p>The word <strong>type</strong> “ogre” does not appear in <em>Moby Dick</em>.</p>
</blockquote>
</div>
</div>
</section>
<section id="notation" class="level3">
<h3 class="anchored" data-anchor-id="notation">Notation</h3>
<section id="words-and-variables" class="level4">
<h4 class="anchored" data-anchor-id="words-and-variables">Words and variables</h4>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>text</strong></td>
<td style="text-align: center;">Call</td>
<td style="text-align: center;">me</td>
<td style="text-align: center;">Ishmael</td>
<td style="text-align: center;">.</td>
<td style="text-align: center;">Some</td>
<td style="text-align: center;">years</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><strong>math standin</strong></td>
<td style="text-align: center;"><span class="math inline">\(w_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(w_2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(w_3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(w_4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(w_5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(w_6\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(w_i\)</span></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math Notation
</div>
</div>
<div class="callout-body-container callout-body">
<dl>
<dt><span class="math inline">\(w_2\)</span></dt>
<dd>
<p>Literally the second word in a sequence.</p>
</dd>
<dt><span class="math inline">\(w_i\)</span></dt>
<dd>
<p>The <span class="math inline">\(i\)</span><sup>th</sup> word in the sequence (that is, any arbitrary word).</p>
</dd>
</dl>
</div>
</div>
</section>
<section id="counting-words" class="level4">
<h4 class="anchored" data-anchor-id="counting-words">Counting Words</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="jrkwetfklu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jrkwetfklu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jrkwetfklu thead, #jrkwetfklu tbody, #jrkwetfklu tfoot, #jrkwetfklu tr, #jrkwetfklu td, #jrkwetfklu th {
  border-style: none;
}

#jrkwetfklu p {
  margin: 0;
  padding: 0;
}

#jrkwetfklu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jrkwetfklu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jrkwetfklu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jrkwetfklu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jrkwetfklu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jrkwetfklu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrkwetfklu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jrkwetfklu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jrkwetfklu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jrkwetfklu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jrkwetfklu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jrkwetfklu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jrkwetfklu .gt_spanner_row {
  border-bottom-style: hidden;
}

#jrkwetfklu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jrkwetfklu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jrkwetfklu .gt_from_md > :first-child {
  margin-top: 0;
}

#jrkwetfklu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jrkwetfklu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jrkwetfklu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jrkwetfklu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jrkwetfklu .gt_row_group_first td {
  border-top-width: 2px;
}

#jrkwetfklu .gt_row_group_first th {
  border-top-width: 2px;
}

#jrkwetfklu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrkwetfklu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jrkwetfklu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jrkwetfklu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrkwetfklu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrkwetfklu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jrkwetfklu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jrkwetfklu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jrkwetfklu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrkwetfklu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jrkwetfklu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrkwetfklu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jrkwetfklu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrkwetfklu .gt_left {
  text-align: left;
}

#jrkwetfklu .gt_center {
  text-align: center;
}

#jrkwetfklu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jrkwetfklu .gt_font_normal {
  font-weight: normal;
}

#jrkwetfklu .gt_font_bold {
  font-weight: bold;
}

#jrkwetfklu .gt_font_italic {
  font-style: italic;
}

#jrkwetfklu .gt_super {
  font-size: 65%;
}

#jrkwetfklu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jrkwetfklu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jrkwetfklu .gt_indent_1 {
  text-indent: 5px;
}

#jrkwetfklu .gt_indent_2 {
  text-indent: 10px;
}

#jrkwetfklu .gt_indent_3 {
  text-indent: 15px;
}

#jrkwetfklu .gt_indent_4 {
  text-indent: 20px;
}

#jrkwetfklu .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Counts of each type in Moby Dick</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="token" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">token</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="math" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">math</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="token">Call</td>
<td class="gt_row gt_right" headers="n">3</td>
<td class="gt_row gt_center" headers="math"><p><span class="math inline">\(C(w_1) = 3\)</span></p></td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="token">me</td>
<td class="gt_row gt_right" headers="n">607</td>
<td class="gt_row gt_center" headers="math"><p><span class="math inline">\(C(w_2) = 607\)</span></p></td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="token">Ishmael</td>
<td class="gt_row gt_right" headers="n">18</td>
<td class="gt_row gt_center" headers="math"><p><span class="math inline">\(C(w_3) = 18\)</span></p></td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="token">.</td>
<td class="gt_row gt_right" headers="n">7164</td>
<td class="gt_row gt_center" headers="math"><p><span class="math inline">\(C(w_4) = 7164\)</span></p></td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="token">Some</td>
<td class="gt_row gt_right" headers="n">38</td>
<td class="gt_row gt_center" headers="math"><p><span class="math inline">\(C(w_5) = 38\)</span></p></td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="token">years</td>
<td class="gt_row gt_right" headers="n">91</td>
<td class="gt_row gt_center" headers="math"><p><span class="math inline">\(C(w_6) = 91\)</span></p></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math Notation
</div>
</div>
<div class="callout-body-container callout-body">
<dl>
<dt><span class="math inline">\(C()\)</span></dt>
<dd>
<p>A function for the “C”ount of a value.</p>
</dd>
<dt><span class="math inline">\(C(w_1)\)</span></dt>
<dd>
<p>The frequency of the <em>type</em> of the first <em>token</em></p>
</dd>
<dt><span class="math inline">\(C(w_i)\)</span></dt>
<dd>
<p>The frequency of an arbitrary type.</p>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="xmfxmmmqty" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xmfxmmmqty table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xmfxmmmqty thead, #xmfxmmmqty tbody, #xmfxmmmqty tfoot, #xmfxmmmqty tr, #xmfxmmmqty td, #xmfxmmmqty th {
  border-style: none;
}

#xmfxmmmqty p {
  margin: 0;
  padding: 0;
}

#xmfxmmmqty .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xmfxmmmqty .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xmfxmmmqty .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xmfxmmmqty .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xmfxmmmqty .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xmfxmmmqty .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmfxmmmqty .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xmfxmmmqty .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xmfxmmmqty .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xmfxmmmqty .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xmfxmmmqty .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xmfxmmmqty .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xmfxmmmqty .gt_spanner_row {
  border-bottom-style: hidden;
}

#xmfxmmmqty .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xmfxmmmqty .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xmfxmmmqty .gt_from_md > :first-child {
  margin-top: 0;
}

#xmfxmmmqty .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xmfxmmmqty .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xmfxmmmqty .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xmfxmmmqty .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xmfxmmmqty .gt_row_group_first td {
  border-top-width: 2px;
}

#xmfxmmmqty .gt_row_group_first th {
  border-top-width: 2px;
}

#xmfxmmmqty .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmfxmmmqty .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xmfxmmmqty .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xmfxmmmqty .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmfxmmmqty .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmfxmmmqty .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xmfxmmmqty .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xmfxmmmqty .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xmfxmmmqty .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xmfxmmmqty .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xmfxmmmqty .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmfxmmmqty .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xmfxmmmqty .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xmfxmmmqty .gt_left {
  text-align: left;
}

#xmfxmmmqty .gt_center {
  text-align: center;
}

#xmfxmmmqty .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xmfxmmmqty .gt_font_normal {
  font-weight: normal;
}

#xmfxmmmqty .gt_font_bold {
  font-weight: bold;
}

#xmfxmmmqty .gt_font_italic {
  font-style: italic;
}

#xmfxmmmqty .gt_super {
  font-size: 65%;
}

#xmfxmmmqty .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xmfxmmmqty .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xmfxmmmqty .gt_indent_1 {
  text-indent: 5px;
}

#xmfxmmmqty .gt_indent_2 {
  text-indent: 10px;
}

#xmfxmmmqty .gt_indent_3 {
  text-indent: 15px;
}

#xmfxmmmqty .gt_indent_4 {
  text-indent: 20px;
}

#xmfxmmmqty .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header gt_col_headings">
<th id="token" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">token</th>
<th id="next token" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">next token</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="math" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">math</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="token">Call</td>
<td class="gt_row gt_left" headers="next token">me</td>
<td class="gt_row gt_center" headers="n">1</td>
<td class="gt_row gt_left" headers="math"><p><span class="math inline">\(C(w_1w_2) = 1\)</span></p></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="token">me</td>
<td class="gt_row gt_left" headers="next token">Ishmael</td>
<td class="gt_row gt_center" headers="n">1</td>
<td class="gt_row gt_left" headers="math"><p><span class="math inline">\(C(w_2w_3) = 1\)</span></p></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="token">Ishmael</td>
<td class="gt_row gt_left" headers="next token">.</td>
<td class="gt_row gt_center" headers="n">3</td>
<td class="gt_row gt_left" headers="math"><p><span class="math inline">\(C(w_3w_4) = 3\)</span></p></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="token">.</td>
<td class="gt_row gt_left" headers="next token">Some</td>
<td class="gt_row gt_center" headers="n">27</td>
<td class="gt_row gt_left" headers="math"><p><span class="math inline">\(C(w_4w_5) = 27\)</span></p></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="token">Some</td>
<td class="gt_row gt_left" headers="next token">years</td>
<td class="gt_row gt_center" headers="n">1</td>
<td class="gt_row gt_left" headers="math"><p><span class="math inline">\(C(w_5w_6) = 1\)</span></p></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math Notation
</div>
</div>
<div class="callout-body-container callout-body">
<dl>
<dt><span class="math inline">\(C(w_1w_2)\)</span></dt>
<dd>
<p>The count of times the sequence <span class="math inline">\(w_1w_2\)</span> occured.</p>
</dd>
<dt><span class="math inline">\(C(w_iw_{i+1})\)</span></dt>
<dd>
<p>The count of times an arbitrary 2 word sequence appeared</p>
</dd>
<dt><span class="math inline">\(C(w_{i-1}w_i)\)</span></dt>
<dd>
<p>Same as before, but with emphasis on the second word.</p>
</dd>
</dl>
</div>
</div>
</section>
<section id="probabilities" class="level4">
<h4 class="anchored" data-anchor-id="probabilities">Probabilities</h4>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Math Notation
</div>
</div>
<div class="callout-body-container callout-body">
<dl>
<dt><span class="math inline">\(P(w_1)\)</span></dt>
<dd>
<p>The <em>probability</em> of the first word</p>
</dd>
<dt><span class="math inline">\(P(w_i)\)</span></dt>
<dd>
<p>The probability of an arbitrary word</p>
</dd>
<dt><span class="math inline">\(P(w_2|w_1)\)</span></dt>
<dd>
<p>The probability that we’ll get word 2 coming after word 1</p>
</dd>
<dt><span class="math inline">\(P(w_i|w_{i-1})\)</span></dt>
<dd>
<p>The probability we’ll get any arbitrary word coming after the word before.</p>
</dd>
</dl>
</div>
</div>
</section>
</section>
</section>
<section id="language-prediction" class="level2">
<h2 class="anchored" data-anchor-id="language-prediction">Language Prediction</h2>
<p>When we are perceiving language, we are constantly and in real-time making predictions about what we are about to hear next. While we’re going to be talking about this in terms of predicting the next word, It’s been shown that we do this even partway through a word <span class="citation" data-cites="allopenna1998">(<a href="#ref-allopenna1998" role="doc-biblioref">Allopenna, Magnuson, and Tanenhaus 1998</a>)</span>.</p>
<p>So, let’s say I spoke this much of a sentence to you:</p>
<blockquote class="blockquote">
<p>I could tell he was angry from the tone of his___</p>
</blockquote>
<p>And then a sudden noise obscured the final word, and you only caught part of it. Which of the following three words was I <em>probably</em> trying to say?</p>
<ol type="a">
<li>boys</li>
<li>choice</li>
<li>voice</li>
</ol>
<p>Your ability to guess which word it was is based on your i) experience with English turns of phrase and ii) the information in the context.</p>
<p>One goal of Language Models is to assign probabilities across the vocabulary for what the next word will be, and hopefully assign higher probabilities to the “correct” answer than the “incorrect” answer. Applications for this kind of prediction range from speech-to-text (which could suffer from a very similar circumstance as the fictional one above) to autocomplete or spellcheck.</p>
</section>
<section id="using-context-ngrams" class="level2">
<h2 class="anchored" data-anchor-id="using-context-ngrams">Using context (ngrams)</h2>
<p>In the example sentence above, one way we could go about trying to predict which word is most likely is to count up how many times the phrase “I could tell he was angry from the tone of his___” is finished by the candidate words. Here’s a table of google hits for the three possible phrases, as well as all hits for just the context phrase.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">“I could tell he was angry from the tone of his”</th>
<th style="text-align: right;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">boys</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">choice</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">voice</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>“I could tell he was angry from the tone of his”</em></td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
<p>We’re going to start diving into mathematical formulas now (fortunately the numbers are easy right now).</p>
<p>To represent the count of a word or string of words in a corpus. We’ll use <span class="math inline">\(C(\text{word})\)</span>. So given the table above we have</p>
<table class="table">
<colgroup>
<col style="width: 72%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(C(\text{I could tell he was angry from the tone of his})\)</span></td>
<td style="text-align: center;">=</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(C(\text{I could tell he was angry from the tone of his boys})\)</span></td>
<td style="text-align: center;">=</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(C(\text{I could tell he was angry from the tone of his choice})\)</span></td>
<td style="text-align: center;">=</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(C(\text{I could tell he was angry from the tone of his voice})\)</span></td>
<td style="text-align: center;">=</td>
<td style="text-align: left;">3</td>
</tr>
</tbody>
</table>
<p>To describe the probability that the next word is “choice” given that we’ve already heard “I could tell he was angry from the tone of his”, we’ll use the notation <span class="math inline">\(P(\text{choice} | \text{I could tell he was angry from the tone of his})\)</span>. To <em>calculate</em> that probability, we’ll divide the total count of the whole phrase by the count of the preceding context.</p>
<p><span class="math display">\[
P(\text{choice} | \text{I could tell he was angry from the tone of his}) = \frac{C(\text{I could tell he was angry by the tone of his choice})}{C(\text{I could tell he was angry by the tone of his})} = \frac{0}{3} = 0
\]</span></p>
<p>Or, more generally:</p>
<p><span class="math display">\[
P(w_i|w_{i-n}\dots w_{i-1}) = \frac{w_{i-n}\dots w_i}{w_{i-n}\dots w_{i-1}}
\]</span></p>
<p>In fact, we can estimate the probability of an entire sentence with the <em>Probability Chain Rule</em>. The probability of a sequence of events like <span class="math inline">\(P(X_1X_2X_3)\)</span> can be estimated by multiplying out their conditional probabilities like so:</p>
<p><span class="math display">\[
P(X_1X_2X_3) = P(X_1)P(X_2|X_1)P(X_3|X_1X_2)
\]</span></p>
<p>Or, to use a phrase as an example:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span class="math display">\[
P(\text{du hast mich gefragt})=P(\text{du})P(\text{hast}|\text{du})P(\text{mich}|\text{du hast})P(\text{gefragt}|\text{du hast mich})
\]</span></p>
</section>
<section id="data-sparsity" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="data-sparsity">Data Sparsity</h2>
<p>The problem we face is that, even with the whole internet to search, very long phrases like <em>“I could tell he was angry by the tone of his”</em> are relatively rare!</p>
<p>If we look at <em>Moby Dick</em>, using a standard tokenizer (more on that later) we wind up with 255,958 words in total. But not every word is equally likely.</p>
<div class="cell">

</div>
<div class="cell page-columns page-full" data-layout-align="center" data-crop="true">
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="04_ngrams_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Rank and Frequency of single words in Moby Dick</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p>And as the size of the ngrams increases, the sparsity gets worse.</p>
<div class="cell page-columns page-full" data-layout-align="center" data-crop="true">
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="04_ngrams_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Rank and Frequency of 2-grams through 5-grams in Moby Dick</figcaption>
</figure>
</div>
</div>
</div>
<p>A “Hapax Legomenon” is a word or phrase that occurs just once in a corpus. If we look at the 2-grams through 5-grams in Moby Dick and make a plot of what proportion of tokens are hapax legomena, we can see that almost <em>all</em> 5grams appear just once.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="04_ngrams_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">The proportion of all tokens which are hapax legomena</figcaption>
</figure>
</div>
</div>
</div>
<section id="the-problem-with-data-sparsity" class="level3">
<h3 class="anchored" data-anchor-id="the-problem-with-data-sparsity">The <em>problem</em> with data sparsity</h3>
<p>Let’s say we got the following sequence of 4 words, and I wanted to predict the 5th</p>
<table class="table">
<tbody>
<tr class="odd">
<td>a</td>
<td>man</td>
<td>is</td>
<td>elevated</td>
<td>?</td>
</tr>
<tr class="even">
<td><span class="math inline">\(w_1\)</span></td>
<td><span class="math inline">\(w_2\)</span></td>
<td><span class="math inline">\(w_3\)</span></td>
<td><span class="math inline">\(w_4\)</span></td>
<td><span class="math inline">\(w_5\)</span></td>
</tr>
</tbody>
</table>
<p>So, for each word type, I want to know</p>
<p><span class="math display">\[
P(w_i | \text{a man is elevated})
\]</span></p>
<p>We know this is going to be calculated with this formula:</p>
<p><span class="math display">\[
\frac{C(\text{a man is elevated }w_i)}{C(\text{a man is elevated)}}
\]</span></p>
<p>From the 4gram counts, I’ll grab a table of the frequency of “a man is elevated”.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="wvzonanogb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wvzonanogb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wvzonanogb thead, #wvzonanogb tbody, #wvzonanogb tfoot, #wvzonanogb tr, #wvzonanogb td, #wvzonanogb th {
  border-style: none;
}

#wvzonanogb p {
  margin: 0;
  padding: 0;
}

#wvzonanogb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wvzonanogb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wvzonanogb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wvzonanogb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wvzonanogb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wvzonanogb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wvzonanogb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wvzonanogb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wvzonanogb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wvzonanogb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wvzonanogb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wvzonanogb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wvzonanogb .gt_spanner_row {
  border-bottom-style: hidden;
}

#wvzonanogb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wvzonanogb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wvzonanogb .gt_from_md > :first-child {
  margin-top: 0;
}

#wvzonanogb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wvzonanogb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wvzonanogb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wvzonanogb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wvzonanogb .gt_row_group_first td {
  border-top-width: 2px;
}

#wvzonanogb .gt_row_group_first th {
  border-top-width: 2px;
}

#wvzonanogb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvzonanogb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wvzonanogb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wvzonanogb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wvzonanogb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvzonanogb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wvzonanogb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wvzonanogb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wvzonanogb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wvzonanogb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wvzonanogb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvzonanogb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wvzonanogb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvzonanogb .gt_left {
  text-align: left;
}

#wvzonanogb .gt_center {
  text-align: center;
}

#wvzonanogb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wvzonanogb .gt_font_normal {
  font-weight: normal;
}

#wvzonanogb .gt_font_bold {
  font-weight: bold;
}

#wvzonanogb .gt_font_italic {
  font-style: italic;
}

#wvzonanogb .gt_super {
  font-size: 65%;
}

#wvzonanogb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wvzonanogb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wvzonanogb .gt_indent_1 {
  text-indent: 5px;
}

#wvzonanogb .gt_indent_2 {
  text-indent: 10px;
}

#wvzonanogb .gt_indent_3 {
  text-indent: 15px;
}

#wvzonanogb .gt_indent_4 {
  text-indent: 20px;
}

#wvzonanogb .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="4gram" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">4gram</th>
<th id="freq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">freq</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="4gram">a man is elevated</td>
<td class="gt_row gt_right" headers="freq">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>It looks like <em>“a man is elevated”</em> appeared just once, so it follows that the 5gram that starts with <em>“a man is elevated”</em> also appears just once.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="eoluzgtkmv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eoluzgtkmv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eoluzgtkmv thead, #eoluzgtkmv tbody, #eoluzgtkmv tfoot, #eoluzgtkmv tr, #eoluzgtkmv td, #eoluzgtkmv th {
  border-style: none;
}

#eoluzgtkmv p {
  margin: 0;
  padding: 0;
}

#eoluzgtkmv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eoluzgtkmv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eoluzgtkmv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eoluzgtkmv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eoluzgtkmv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eoluzgtkmv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eoluzgtkmv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eoluzgtkmv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eoluzgtkmv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eoluzgtkmv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eoluzgtkmv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eoluzgtkmv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eoluzgtkmv .gt_spanner_row {
  border-bottom-style: hidden;
}

#eoluzgtkmv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eoluzgtkmv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eoluzgtkmv .gt_from_md > :first-child {
  margin-top: 0;
}

#eoluzgtkmv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eoluzgtkmv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eoluzgtkmv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eoluzgtkmv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eoluzgtkmv .gt_row_group_first td {
  border-top-width: 2px;
}

#eoluzgtkmv .gt_row_group_first th {
  border-top-width: 2px;
}

#eoluzgtkmv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eoluzgtkmv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eoluzgtkmv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eoluzgtkmv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eoluzgtkmv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eoluzgtkmv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eoluzgtkmv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eoluzgtkmv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eoluzgtkmv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eoluzgtkmv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eoluzgtkmv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eoluzgtkmv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eoluzgtkmv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eoluzgtkmv .gt_left {
  text-align: left;
}

#eoluzgtkmv .gt_center {
  text-align: center;
}

#eoluzgtkmv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eoluzgtkmv .gt_font_normal {
  font-weight: normal;
}

#eoluzgtkmv .gt_font_bold {
  font-weight: bold;
}

#eoluzgtkmv .gt_font_italic {
  font-style: italic;
}

#eoluzgtkmv .gt_super {
  font-size: 65%;
}

#eoluzgtkmv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eoluzgtkmv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eoluzgtkmv .gt_indent_1 {
  text-indent: 5px;
}

#eoluzgtkmv .gt_indent_2 {
  text-indent: 10px;
}

#eoluzgtkmv .gt_indent_3 {
  text-indent: 15px;
}

#eoluzgtkmv .gt_indent_4 {
  text-indent: 20px;
}

#eoluzgtkmv .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="5gram" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">5gram</th>
<th id="freq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">freq</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="5gram">a man is elevated in</td>
<td class="gt_row gt_right" headers="freq">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>If we wanted to compare the probabilities of the words <em>in</em> and <em>to</em> in this context. we’d wind up with the following results.</p>
<p><span class="math display">\[
P(\text{in} | \text{a man is elevated}) = \frac{C(\text{a man is elevated in})}{C(\text{a man is elevated)}} = \frac{1}{1} = 1
\]</span></p>
<p><span class="math display">\[
P(\text{to} | \text{a man is elevated}) = \frac{C(\text{a man is elevated to})}{C(\text{a man is elevated)}} = \frac{0}{1} = 0
\]</span></p>
<p>According to this 5gram model trained on Moby Dick, there’s a <em>0% chance</em> that the next word could be <em>“to”</em>.</p>
<p>Is that really reasonable?</p>
</section>
<section id="approximating-with-ngrams" class="level3">
<h3 class="anchored" data-anchor-id="approximating-with-ngrams">Approximating with ngrams</h3>
<p>Instead of using long ngrams, we can try approximating with shorter ngrams (known as the Markov Assumption).</p>
<p><span class="math display">\[
P(\text{in} | \text{a man is elevated}) \approx P(\text{in} | \text{elevated})
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="euomfdlmtq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#euomfdlmtq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#euomfdlmtq thead, #euomfdlmtq tbody, #euomfdlmtq tfoot, #euomfdlmtq tr, #euomfdlmtq td, #euomfdlmtq th {
  border-style: none;
}

#euomfdlmtq p {
  margin: 0;
  padding: 0;
}

#euomfdlmtq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#euomfdlmtq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#euomfdlmtq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#euomfdlmtq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#euomfdlmtq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#euomfdlmtq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#euomfdlmtq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#euomfdlmtq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#euomfdlmtq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#euomfdlmtq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#euomfdlmtq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#euomfdlmtq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#euomfdlmtq .gt_spanner_row {
  border-bottom-style: hidden;
}

#euomfdlmtq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#euomfdlmtq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#euomfdlmtq .gt_from_md > :first-child {
  margin-top: 0;
}

#euomfdlmtq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#euomfdlmtq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#euomfdlmtq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#euomfdlmtq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#euomfdlmtq .gt_row_group_first td {
  border-top-width: 2px;
}

#euomfdlmtq .gt_row_group_first th {
  border-top-width: 2px;
}

#euomfdlmtq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#euomfdlmtq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#euomfdlmtq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#euomfdlmtq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#euomfdlmtq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#euomfdlmtq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#euomfdlmtq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#euomfdlmtq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#euomfdlmtq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#euomfdlmtq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#euomfdlmtq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#euomfdlmtq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#euomfdlmtq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#euomfdlmtq .gt_left {
  text-align: left;
}

#euomfdlmtq .gt_center {
  text-align: center;
}

#euomfdlmtq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#euomfdlmtq .gt_font_normal {
  font-weight: normal;
}

#euomfdlmtq .gt_font_bold {
  font-weight: bold;
}

#euomfdlmtq .gt_font_italic {
  font-style: italic;
}

#euomfdlmtq .gt_super {
  font-size: 65%;
}

#euomfdlmtq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#euomfdlmtq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#euomfdlmtq .gt_indent_1 {
  text-indent: 5px;
}

#euomfdlmtq .gt_indent_2 {
  text-indent: 10px;
}

#euomfdlmtq .gt_indent_3 {
  text-indent: 15px;
}

#euomfdlmtq .gt_indent_4 {
  text-indent: 20px;
}

#euomfdlmtq .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="bigrams" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bigrams</th>
<th id="freq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">freq</th>
<th id="\(P(w_i)\)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">\(P(w_i)\)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="bigrams">elevated above</td>
<td class="gt_row gt_right" headers="freq">2</td>
<td class="gt_row gt_right" headers="prob">0.18</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="bigrams">elevated ,</td>
<td class="gt_row gt_right" headers="freq">2</td>
<td class="gt_row gt_right" headers="prob">0.18</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="bigrams">elevated out</td>
<td class="gt_row gt_right" headers="freq">2</td>
<td class="gt_row gt_right" headers="prob">0.18</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="bigrams">elevated in</td>
<td class="gt_row gt_right" headers="freq">1</td>
<td class="gt_row gt_right" headers="prob">0.09</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="bigrams">elevated quarter-deck</td>
<td class="gt_row gt_right" headers="freq">1</td>
<td class="gt_row gt_right" headers="prob">0.09</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="bigrams">elevated hump</td>
<td class="gt_row gt_right" headers="freq">1</td>
<td class="gt_row gt_right" headers="prob">0.09</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="bigrams">elevated part</td>
<td class="gt_row gt_right" headers="freq">1</td>
<td class="gt_row gt_right" headers="prob">0.09</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="bigrams">elevated open-work</td>
<td class="gt_row gt_right" headers="freq">1</td>
<td class="gt_row gt_right" headers="prob">0.09</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
</section>
<section id="calculating-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="calculating-probabilities">Calculating probabilities</h2>
<p>Remember this chain rule?</p>
<p><span class="math display">\[
P(\text{du hast mich gefragt})=P(\text{du})P(\text{hast}|\text{du})P(\text{mich}|\text{du hast})P(\text{gefragt}|\text{du hast mich})
\]</span></p>
<p>We’d simplify this, like so:</p>
<p><span class="math display">\[
P(\text{du hast mich gefragt}) = P({\text{du} | \text{\#}})P(\text{hast} | \text{du})P(\text{mich} | \text{hast})P(\text{gefragt}|\text{mich})
\]</span></p>
<section id="log-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="log-probabilities">Log Probabilities</h3>
<p>There’s an additional complication about how we represent probabilities. Let’s build a very probable 10 word string starting with <em>“The”.</em> I’ll just grab the most frequent <span class="math inline">\(w_i\)</span> that comes after <span class="math inline">\(w_{i-1}\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="chyjhrvnqf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#chyjhrvnqf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#chyjhrvnqf thead, #chyjhrvnqf tbody, #chyjhrvnqf tfoot, #chyjhrvnqf tr, #chyjhrvnqf td, #chyjhrvnqf th {
  border-style: none;
}

#chyjhrvnqf p {
  margin: 0;
  padding: 0;
}

#chyjhrvnqf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#chyjhrvnqf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#chyjhrvnqf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#chyjhrvnqf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#chyjhrvnqf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chyjhrvnqf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chyjhrvnqf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chyjhrvnqf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#chyjhrvnqf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#chyjhrvnqf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#chyjhrvnqf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#chyjhrvnqf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#chyjhrvnqf .gt_spanner_row {
  border-bottom-style: hidden;
}

#chyjhrvnqf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#chyjhrvnqf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#chyjhrvnqf .gt_from_md > :first-child {
  margin-top: 0;
}

#chyjhrvnqf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#chyjhrvnqf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#chyjhrvnqf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#chyjhrvnqf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#chyjhrvnqf .gt_row_group_first td {
  border-top-width: 2px;
}

#chyjhrvnqf .gt_row_group_first th {
  border-top-width: 2px;
}

#chyjhrvnqf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#chyjhrvnqf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#chyjhrvnqf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#chyjhrvnqf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chyjhrvnqf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#chyjhrvnqf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#chyjhrvnqf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#chyjhrvnqf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#chyjhrvnqf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chyjhrvnqf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chyjhrvnqf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#chyjhrvnqf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chyjhrvnqf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#chyjhrvnqf .gt_left {
  text-align: left;
}

#chyjhrvnqf .gt_center {
  text-align: center;
}

#chyjhrvnqf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#chyjhrvnqf .gt_font_normal {
  font-weight: normal;
}

#chyjhrvnqf .gt_font_bold {
  font-weight: bold;
}

#chyjhrvnqf .gt_font_italic {
  font-style: italic;
}

#chyjhrvnqf .gt_super {
  font-size: 65%;
}

#chyjhrvnqf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#chyjhrvnqf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#chyjhrvnqf .gt_indent_1 {
  text-indent: 5px;
}

#chyjhrvnqf .gt_indent_2 {
  text-indent: 10px;
}

#chyjhrvnqf .gt_indent_3 {
  text-indent: 15px;
}

#chyjhrvnqf .gt_indent_4 {
  text-indent: 20px;
}

#chyjhrvnqf .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="bigram" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bigram</th>
<th id="freq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">freq</th>
<th id="\(P(w_i | w_{i-1})\)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">\(P(w_i | w_{i-1})\)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">The Pequod</td>
<td class="gt_row gt_right" headers="freq">15</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">Pequod ’</td>
<td class="gt_row gt_right" headers="freq">49</td>
<td class="gt_row gt_right" headers="prob">0.28</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">’ s</td>
<td class="gt_row gt_right" headers="freq">1,784</td>
<td class="gt_row gt_right" headers="prob">0.64</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">s a</td>
<td class="gt_row gt_right" headers="freq">73</td>
<td class="gt_row gt_right" headers="prob">0.04</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">a little</td>
<td class="gt_row gt_right" headers="freq">105</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">little ,</td>
<td class="gt_row gt_right" headers="freq">11</td>
<td class="gt_row gt_right" headers="prob">0.04</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">, and</td>
<td class="gt_row gt_right" headers="freq">2,630</td>
<td class="gt_row gt_right" headers="prob">0.14</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">and the</td>
<td class="gt_row gt_right" headers="freq">361</td>
<td class="gt_row gt_right" headers="prob">0.06</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">the whale</td>
<td class="gt_row gt_right" headers="freq">325</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">whale ,</td>
<td class="gt_row gt_right" headers="freq">173</td>
<td class="gt_row gt_right" headers="prob">0.22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "&gt; The Pequod’s a little, and the whale,"</code></pre>
</div>
</div>
<p>We can calculate the cumulative probability of each next substring of the sentence.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="kmtalpmfek" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kmtalpmfek table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kmtalpmfek thead, #kmtalpmfek tbody, #kmtalpmfek tfoot, #kmtalpmfek tr, #kmtalpmfek td, #kmtalpmfek th {
  border-style: none;
}

#kmtalpmfek p {
  margin: 0;
  padding: 0;
}

#kmtalpmfek .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kmtalpmfek .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kmtalpmfek .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kmtalpmfek .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kmtalpmfek .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmtalpmfek .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmtalpmfek .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmtalpmfek .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kmtalpmfek .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kmtalpmfek .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kmtalpmfek .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kmtalpmfek .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kmtalpmfek .gt_spanner_row {
  border-bottom-style: hidden;
}

#kmtalpmfek .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kmtalpmfek .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kmtalpmfek .gt_from_md > :first-child {
  margin-top: 0;
}

#kmtalpmfek .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kmtalpmfek .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kmtalpmfek .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kmtalpmfek .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kmtalpmfek .gt_row_group_first td {
  border-top-width: 2px;
}

#kmtalpmfek .gt_row_group_first th {
  border-top-width: 2px;
}

#kmtalpmfek .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmtalpmfek .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kmtalpmfek .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kmtalpmfek .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmtalpmfek .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmtalpmfek .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kmtalpmfek .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kmtalpmfek .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kmtalpmfek .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmtalpmfek .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmtalpmfek .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmtalpmfek .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmtalpmfek .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmtalpmfek .gt_left {
  text-align: left;
}

#kmtalpmfek .gt_center {
  text-align: center;
}

#kmtalpmfek .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kmtalpmfek .gt_font_normal {
  font-weight: normal;
}

#kmtalpmfek .gt_font_bold {
  font-weight: bold;
}

#kmtalpmfek .gt_font_italic {
  font-style: italic;
}

#kmtalpmfek .gt_super {
  font-size: 65%;
}

#kmtalpmfek .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kmtalpmfek .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kmtalpmfek .gt_indent_1 {
  text-indent: 5px;
}

#kmtalpmfek .gt_indent_2 {
  text-indent: 10px;
}

#kmtalpmfek .gt_indent_3 {
  text-indent: 15px;
}

#kmtalpmfek .gt_indent_4 {
  text-indent: 20px;
}

#kmtalpmfek .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="bigram" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bigram</th>
<th id="freq" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">freq</th>
<th id="\(P(w_i | w_{i-1})\)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">\(P(w_i | w_{i-1})\)</th>
<th id="\(P(w_{i-n}\dots w_i)\)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">\(P(w_{i-n}\dots w_i)\)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">The Pequod</td>
<td class="gt_row gt_right" headers="freq">15</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
<td class="gt_row gt_right" headers="total_prob">0.0216763006</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">Pequod ’</td>
<td class="gt_row gt_right" headers="freq">49</td>
<td class="gt_row gt_right" headers="prob">0.28</td>
<td class="gt_row gt_right" headers="total_prob">0.0060693642</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">’ s</td>
<td class="gt_row gt_right" headers="freq">1,784</td>
<td class="gt_row gt_right" headers="prob">0.64</td>
<td class="gt_row gt_right" headers="total_prob">0.0038809124</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">s a</td>
<td class="gt_row gt_right" headers="freq">73</td>
<td class="gt_row gt_right" headers="prob">0.04</td>
<td class="gt_row gt_right" headers="total_prob">0.0001588042</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">a little</td>
<td class="gt_row gt_right" headers="freq">105</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
<td class="gt_row gt_right" headers="total_prob">0.0000036997</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">little ,</td>
<td class="gt_row gt_right" headers="freq">11</td>
<td class="gt_row gt_right" headers="prob">0.04</td>
<td class="gt_row gt_right" headers="total_prob">0.0000001648</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">, and</td>
<td class="gt_row gt_right" headers="freq">2,630</td>
<td class="gt_row gt_right" headers="prob">0.14</td>
<td class="gt_row gt_right" headers="total_prob">0.0000000226</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">and the</td>
<td class="gt_row gt_right" headers="freq">361</td>
<td class="gt_row gt_right" headers="prob">0.06</td>
<td class="gt_row gt_right" headers="total_prob">0.0000000014</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">the whale</td>
<td class="gt_row gt_right" headers="freq">325</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
<td class="gt_row gt_right" headers="total_prob">0.0000000000</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">whale ,</td>
<td class="gt_row gt_right" headers="freq">173</td>
<td class="gt_row gt_right" headers="prob">0.22</td>
<td class="gt_row gt_right" headers="total_prob">0.0000000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>I artificially clamped the number of decimal points that would show in the final column to 10, but because of the way computers represent decimal points, they <em>also</em> have a lower limit they can get to.</p>
<p>To avoid things getting weird with decimals that are too small, these probabilities will often be represented as <em>log</em> probabilities.</p>
<p>If you don’t remember how logarithms work, that’s ok. There’s just a few useful properties to remember.</p>
<p><span class="math display">\[
\log(x)  \left\{ \begin{array}{c} &gt; 0; x&gt;1\\=0; x =1\\&lt;0; x&lt;1 \end{array} \right\}
\]</span></p>
<p><span class="math display">\[
\log(0) = -\infty
\]</span></p>
<p><span class="math display">\[
\log(x  y) = \log(x) + \log(y)
\]</span></p>
<p><span class="math display">\[
\log(\frac{x}{y}) = \log(x) - \log(y)
\]</span></p>
<div class="cell">
<div class="cell-output-display">
<div>
<div id="dkaotjnvrl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dkaotjnvrl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dkaotjnvrl thead, #dkaotjnvrl tbody, #dkaotjnvrl tfoot, #dkaotjnvrl tr, #dkaotjnvrl td, #dkaotjnvrl th {
  border-style: none;
}

#dkaotjnvrl p {
  margin: 0;
  padding: 0;
}

#dkaotjnvrl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dkaotjnvrl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dkaotjnvrl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dkaotjnvrl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dkaotjnvrl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dkaotjnvrl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkaotjnvrl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dkaotjnvrl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dkaotjnvrl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dkaotjnvrl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dkaotjnvrl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dkaotjnvrl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dkaotjnvrl .gt_spanner_row {
  border-bottom-style: hidden;
}

#dkaotjnvrl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dkaotjnvrl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dkaotjnvrl .gt_from_md > :first-child {
  margin-top: 0;
}

#dkaotjnvrl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dkaotjnvrl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dkaotjnvrl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dkaotjnvrl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dkaotjnvrl .gt_row_group_first td {
  border-top-width: 2px;
}

#dkaotjnvrl .gt_row_group_first th {
  border-top-width: 2px;
}

#dkaotjnvrl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkaotjnvrl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dkaotjnvrl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dkaotjnvrl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkaotjnvrl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkaotjnvrl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dkaotjnvrl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dkaotjnvrl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dkaotjnvrl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dkaotjnvrl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dkaotjnvrl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkaotjnvrl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dkaotjnvrl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dkaotjnvrl .gt_left {
  text-align: left;
}

#dkaotjnvrl .gt_center {
  text-align: center;
}

#dkaotjnvrl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dkaotjnvrl .gt_font_normal {
  font-weight: normal;
}

#dkaotjnvrl .gt_font_bold {
  font-weight: bold;
}

#dkaotjnvrl .gt_font_italic {
  font-style: italic;
}

#dkaotjnvrl .gt_super {
  font-size: 65%;
}

#dkaotjnvrl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dkaotjnvrl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dkaotjnvrl .gt_indent_1 {
  text-indent: 5px;
}

#dkaotjnvrl .gt_indent_2 {
  text-indent: 10px;
}

#dkaotjnvrl .gt_indent_3 {
  text-indent: 15px;
}

#dkaotjnvrl .gt_indent_4 {
  text-indent: 20px;
}

#dkaotjnvrl .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="bigram" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">bigram</th>
<th id="probability" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">probability</th>
<th id="log(prob)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">log(prob)</th>
<th id="total log(prob)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">total log(prob)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">The Pequod</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
<td class="gt_row gt_right" headers="log_prob">−3.83</td>
<td class="gt_row gt_right" headers="total_lp">−3.83</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">Pequod ’</td>
<td class="gt_row gt_right" headers="prob">0.28</td>
<td class="gt_row gt_right" headers="log_prob">−1.27</td>
<td class="gt_row gt_right" headers="total_lp">−5.10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">’ s</td>
<td class="gt_row gt_right" headers="prob">0.64</td>
<td class="gt_row gt_right" headers="log_prob">−0.45</td>
<td class="gt_row gt_right" headers="total_lp">−5.55</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">s a</td>
<td class="gt_row gt_right" headers="prob">0.04</td>
<td class="gt_row gt_right" headers="log_prob">−3.20</td>
<td class="gt_row gt_right" headers="total_lp">−8.75</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">a little</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
<td class="gt_row gt_right" headers="log_prob">−3.76</td>
<td class="gt_row gt_right" headers="total_lp">−12.51</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">little ,</td>
<td class="gt_row gt_right" headers="prob">0.04</td>
<td class="gt_row gt_right" headers="log_prob">−3.11</td>
<td class="gt_row gt_right" headers="total_lp">−15.62</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">, and</td>
<td class="gt_row gt_right" headers="prob">0.14</td>
<td class="gt_row gt_right" headers="log_prob">−1.99</td>
<td class="gt_row gt_right" headers="total_lp">−17.61</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">and the</td>
<td class="gt_row gt_right" headers="prob">0.06</td>
<td class="gt_row gt_right" headers="log_prob">−2.81</td>
<td class="gt_row gt_right" headers="total_lp">−20.42</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="ngrams">the whale</td>
<td class="gt_row gt_right" headers="prob">0.02</td>
<td class="gt_row gt_right" headers="log_prob">−3.74</td>
<td class="gt_row gt_right" headers="total_lp">−24.16</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="ngrams">whale ,</td>
<td class="gt_row gt_right" headers="prob">0.22</td>
<td class="gt_row gt_right" headers="log_prob">−1.49</td>
<td class="gt_row gt_right" headers="total_lp">−25.66</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>



</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-allopenna1998" class="csl-entry" role="listitem">
Allopenna, Paul D., James S. Magnuson, and Michael K. Tanenhaus. 1998. <span>“Tracking the Time Course of Spoken Word Recognition Using Eye Movements: Evidence for Continuous Mapping Models.”</span> <em>Journal of Memory and Language</em> 38 (4): 419–39. <a href="https://doi.org/10.1006/jmla.1997.2558">https://doi.org/10.1006/jmla.1997.2558</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>well, <em>almost</em> all.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Credit here to Kyle Gorman for introducing me to this example.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>If we went longer than 10, we actually get <span class="math inline">\(\text{The Pequod's a little}\overline{\text{, and the whale}}\)</span><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>CC-BY-SA 4.0</div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{fruehwald2024,
  author = {Fruehwald, Josef},
  title = {Ngrams},
  date = {2024-02-13},
  url = {https://lin511-2024.github.io/notes/meetings/04_ngrams.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-fruehwald2024" class="csl-entry quarto-appendix-citeas" role="listitem">
Fruehwald, Josef. 2024. <span>“Ngrams.”</span> February 13, 2024. <a href="https://lin511-2024.github.io/notes/meetings/04_ngrams.html">https://lin511-2024.github.io/notes/meetings/04_ngrams.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/lin511-2024\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../notes/meetings/03_tokenization.html" class="pagination-link" aria-label="Tokenization">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Tokenization</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../notes/meetings/05_ngrams2.html" class="pagination-link" aria-label="Sampling from a probability distribution">
        <span class="nav-page-text">Sampling from a probability distribution</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/orgs/Lin511-2024/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../syllabus/syllabus.html">
      <i class="bi bi-file-text-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="../../syllabus/schedule.html">
      <i class="bi bi-calendar-check-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Lin511-2024/Lin511-2024.github.io/blob/main/notes/meetings/04_ngrams.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>